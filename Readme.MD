# Ollama Cloud Gateway —Å —Ä–æ—Ç–∞—Ü–∏–µ–π –∞–∫–∫–∞—É–Ω—Ç–æ–≤
## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API Gateway –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Ollama Cloud —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–µ–π –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ 429 (—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤). –û—à–∏–±–∫–∞ 429 –≤ Ollama Cloud –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–∞ –∏—Å—á–µ—Ä–ø–∞–Ω –Ω–∞ —Ü–µ–ª—É—é –Ω–µ–¥–µ–ª—é.
## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
–ö–ª–∏–µ–Ω—Ç (Open WebUI) ‚Üí API Gateway ‚Üí Ollama Cloud (—Å —Ä–æ—Ç–∞—Ü–∏–µ–π –∞–∫–∫–∞—É–Ω—Ç–æ–≤)
```
## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–µ 429  
‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–∞ 7 –¥–Ω–µ–π –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–∞  
‚úÖ Round-robin –≤—ã–±–æ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤  
‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Open WebUI  
‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤  
‚úÖ –†—É—á–Ω–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤  
## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
Docker –∏ Docker Compose
API –∫–ª—é—á–∏ Ollama Cloud (–º–∏–Ω–∏–º—É–º 2 –∞–∫–∫–∞—É–Ω—Ç–∞)
Ubuntu —Å–µ—Ä–≤–µ—Ä —Å –¥–æ—Å—Ç—É–ø–æ–º –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
mkdir ollama-cloud-gateway
cd ollama-cloud-gateway

# –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã
mkdir config
```
### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ Ollama Cloud
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª config/cloud_accounts.json:
```
{
  "accounts": [
    {
      "name": "ollama-account-1",
      "api_key": "ollama_xxx_your_actual_api_key_1",
      "description": "Primary account"
    },
    {
      "name": "ollama-account-2", 
      "api_key": "ollama_xxx_your_actual_api_key_2",
      "description": "Backup account 1"
    },
    {
      "name": "ollama-account-3",
      "api_key": "ollama_xxx_your_actual_api_key_3",
      "description": "Backup account 2"
    }
  ]
}
```
### 3. –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile
```
FROM python:3.9-slim

WORKDIR /app

RUN apt-get update && apt-get install -y \
    && rm -rf /var/lib/apt/lists/*

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY ollama_cloud_gateway.py .
RUN mkdir -p /app/config

CMD ["python", "ollama_cloud_gateway.py"]
```
### 4. –°–æ–∑–¥–∞–Ω–∏–µ requirements.txt
```
aiohttp==3.9.1
```
### 5. –°–æ–∑–¥–∞–Ω–∏–µ docker-compose.yml
```commandline
version: '3.8'

services:
  ollama-cloud-gateway:
    build: .
    container_name: ollama-cloud-gateway
    ports:
      - "11435:11435"
    volumes:
      - ./config:/app/config
    restart: unless-stopped

  open-webui:
    image: ghcr.io/open-webui/open-webui:latest
    container_name: open-webui
    ports:
      - "3000:8080"
    volumes:
      - openwebui_data:/app/backend/data
    environment:
      - OLLAMA_BASE_URL=http://ollama-cloud-gateway:11435
    restart: unless-stopped
    depends_on:
      - ollama-cloud-gateway

volumes:
  openwebui_data:
```
### 6. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```commandline
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
sudo docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo docker-compose logs -f
```
## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–ß–µ—Ä–µ–∑ Open WebUI
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:3000
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å—Ç–∞–Ω–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º)
3. –ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ Ollama Cloud —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å 
### –ü—Ä—è–º—ã–µ API –≤—ã–∑–æ–≤—ã
```commandline
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π
curl -X GET http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:11435/api/tags

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
curl -X POST http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:11435/api/generate \
  -H "Content-Type: application/json" \
  -d '{"model": "llama2", "prompt": "Hello world", "stream": false}'
```
### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
```commandline
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
curl http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:11435/admin/status

# –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ (—Ä—É—á–Ω–∞—è)
curl -X POST http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:11435/admin/unblock/ollama-account-1
```
## –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```commandline
# –õ–æ–≥–∏ Gateway
sudo docker logs ollama-cloud-gateway -f

# –õ–æ–≥–∏ Open WebUI
sudo docker logs open-webui -f
```
### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
```commandline
sudo docker-compose restart
```
### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è cloud_accounts.json –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ gateway:
```commandline
sudo docker-compose restart ollama-cloud-gateway
```
### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama Cloud
```commandline
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä—è–º—É—é (–∑–∞–º–µ–Ω–∏—Ç–µ YOUR_API_KEY)
curl -H "Authorization: Bearer YOUR_API_KEY" \
  https://api.ollama.com/v1/models
```
### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã Gateway
```commandline
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Gateway
curl http://localhost:11435/api/tags

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è Open WebUI
curl http://localhost:3000
```
### –ï—Å–ª–∏ –≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: curl http://localhost:11435/admin/status
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç—ã
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ cloud_accounts.json —É–∫–∞–∑–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ API –∫–ª—é—á–∏
## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
   üîí –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ production  
   üîí –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º 3000 –∏ 11435 —á–µ—Ä–µ–∑ —Ñ–∞–π—Ä–≤–æ–ª  
   üîí –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ API –∫–ª—é—á–∏  
   üîí –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤  

   –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
   –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –º–µ–∂–¥—É –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
   –ü—Ä–∏ –æ—à–∏–±–∫–µ 429 –∞–∫–∫–∞—É–Ω—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 7 –¥–Ω–µ–π
   –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–º–µ—Ç—å 3+ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
   –õ–∏—Ü–µ–Ω–∑–∏—è
   –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞
–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ API –∫–ª—é—á–µ–π
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç—ã Ollama Cloud –∞–∫—Ç–∏–≤–Ω—ã
### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
#### –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –Ω–µ —Å–≤—è–∑–∞–Ω —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º Ollama –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ Ollama Cloud.